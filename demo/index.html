<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script type="text/javascript" charset="utf-8" src="https://cdn.jsdelivr.net/npm/clappr@latest/dist/clappr.min.js"></script>
<script type="text/javascript" charset="utf-8" src="main.js"></script>
<script type="text/javascript" charset="utf-8" src="ace.js"></script>
<link rel="shortcut icon" type="image/png" href="http://clappr.io/demo/i/favico.png"><script>
function addExternal(){var e=document.getElementById("js-link");window.clappr.externals.push(e.value),addTag(e.value),e.value=""}
function addTag(e){var a=["aliceblue","antiquewhite","azure","black","blue","brown","yellow","teal"],l=a[Math.floor(Math.random()*a.length)],n=document.createElement("span");n.style.backgroundColor=l,n.className="external-js",n.innerText=e.split(/\//).pop().split(/\./)[0],document.getElementById("external-js-panel").appendChild(n)}window.clappr=window.clappr||{},window.clappr.externals=[];
</script><style type="text/css">
html,body {height:100%; width:100%; padding:0; margin:0; }
#player{position:fixed; height:100%;width:100%; padding:0; margin:0;}</style>	
</head><body><div id="player-wrapper"><script>
      var urlParams;
      (function() {
        window.onpopstate = function () {
          var match,
              pl     = /\+/g,  // Regex for replacing addition symbol with a space
              search = /([^&=]+)=?([^&]*)/g,
              decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
              query  = window.location.search.substring(1);

          urlParams = {};
          while (match = search.exec(query))
            urlParams[decode(match[1])] = decode(match[2]);
        }
        window.onpopstate();
      })();

      var playerElement = document.getElementById("player-wrapper");

      var player = new Clappr.Player({
        source: urlParams.src || 'https://v.sharefa.st/shJfjxiAC4B2.mp4',
        poster: urlParams.poster || 'http://clappr.io/poster.png',
        autoPlay: true,  mute:!1, height:"100%",width:"100%", });
      player.attachTo(playerElement);
      //editor
      window.onload = function() {
        if (window.location.hash) {
          var editorContent = atob(window.location.hash.substr(1))
          document.getElementById("editor").innerHTML = editorContent
          setTimeout(run, 0)
        }
        var editor = ace.edit("editor");
        var session = editor.getSession();
        editor.setTheme("ace/theme/katzenmilch");
        session.setMode("ace/mode/javascript");
        session.setTabSize(2);
        session.setUseSoftTabs(true);
        var parser = new Parser($('#output'));
        var load = function(fn) {
          if (window.clappr.externals.length > 0) {
            var lastScript = window.clappr.externals.length
            window.clappr.externals.forEach(function(url, index) {
	      var script = document.createElement('script')

	      script.setAttribute("type", "text/javascript")
	      script.setAttribute("src", url)
              if (index === (lastScript - 1)) {
		script.onload = fn
              }
	      script.onerror = function(e){alert('we cant load ' + url + ': e' + e)}

	      document.body.appendChild(script)
            })
	  } else {
	    fn()
          }
        }

        $('.run').click(function() {
          run()
        });

        function run() {
          var code = ace.edit('editor').getSession().getValue();
          var b64EncodedCode = btoa(code)
          window.location.hash = b64EncodedCode
          load(function(){parser.parse(code)})
        }
      }
    </script></div> </body></html>
